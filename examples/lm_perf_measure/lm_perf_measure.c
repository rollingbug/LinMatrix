/**
 *******************************************************************************
 * Copyright 2022 Y.H.Kuo
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @noop    ___     ______  _   __
 * @noop   /  /    /_   _/ / \ / /  A lightweight matrix computation SW library.
 * @noop  /  /__  _ / /_  /   \ / __  Use at your own risk.
 * @noop /_____/ /_____/ /_/ \_/ /_/
 * @noop    ______    _____   _______  ____     ______ ___   ___
 * @noop   /      \  /  _  | /__  __/ / __ \   /_   _/ \  \ /  /
 * @noop  /  / /  / /  _   |  /  /   /  -- /  _ / /_   /  --  /
 * @noop /__/_/__/ /__/ \__| /__/   /__/ \_\ /_____/  /__/ \__\
 *
 * @file    lm_perf_measure.c
 * @brief   Lin matrix, performance measurement
 * @author  Y.H.Kuo
 *******************************************************************************
 */

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include <string.h>
#include <math.h>
#include <time.h>

#include "lm_lib.h"


/*
 *******************************************************************************
 * Constant value definition
 *******************************************************************************
 */


/*
 *******************************************************************************
 * Data type definition
 *******************************************************************************
 */

#define LM_MAT_SIZE_R   32
#define LM_MAT_SIZE_C   32


/*
 *******************************************************************************
 * Global variables
 *******************************************************************************
 */

lm_mat_elem_t elem_a[LM_MAT_SIZE_R * LM_MAT_SIZE_C] = {
     1.624989E-01,  1.867664E-01, -3.664906E-02, -4.257766E-01, -1.021640E-01,  1.902866E-01,  2.344227E-01,  1.069317E-01,  7.036327E-03,  4.198171E-01,  4.548217E-01,  1.088751E-01, -1.435964E-02, -6.466128E-02,  3.050914E-01, -1.236900E-01, -3.771428E-01, -3.612667E-01,  1.878680E-01, -2.242172E-01, -5.900494E-02, -5.285113E-02, -3.494519E-01,  1.055889E-01,  2.744572E-01,  2.297904E-01, -2.156582E-01,  3.936693E-01, -3.981782E-01,  3.405589E-01,  3.793040E-01, -3.015407E-01,
     1.067304E-01,  4.918724E-01, -4.619289E-01, -4.130512E-01, -5.937237E-02, -4.084666E-01,  2.821397E-01, -1.724281E-01,  2.229800E-01,  2.698697E-01,  4.280224E-01,  9.937516E-02, -3.643668E-01, -2.894963E-01, -2.475141E-01,  2.927606E-01,  4.102716E-01,  9.252169E-03, -1.256723E-01,  7.705571E-02,  3.491685E-01, -3.023335E-01,  3.740267E-01, -3.869022E-01, -1.550433E-01,  2.371356E-01, -1.985213E-01,  4.414364E-01,  1.160206E-01, -3.072302E-01,  2.513350E-01, -1.069409E-01,
     6.776407E-02,  4.771600E-01,  3.563650E-01, -3.412683E-01,  4.942108E-01,  1.059199E-01, -4.865270E-01,  3.498604E-01, -2.231802E-01,  2.281121E-01, -4.491524E-02,  2.518727E-01, -5.323338E-02, -3.000565E-01, -2.331976E-01,  3.886238E-01,  1.092363E-01,  8.817142E-03, -4.285590E-01, -1.641630E-01, -3.475732E-01,  4.343963E-01, -5.648631E-02, -2.295941E-01, -2.573714E-01,  1.693977E-01, -6.685631E-02, -4.254775E-01, -3.134754E-01, -8.137015E-02, -5.146212E-02, -3.717085E-01,
    -4.959744E-01, -2.015654E-01,  4.686091E-01,  4.912363E-01,  3.936033E-01, -1.507094E-01, -8.027064E-02,  3.051427E-01, -1.681998E-01, -3.272349E-01,  3.304221E-02, -1.115506E-01, -1.239093E-01, -2.050846E-01,  2.429009E-01,  2.555017E-01, -2.196308E-01,  3.420993E-01, -4.448677E-01,  2.919527E-01,  1.599131E-01,  7.924734E-02,  4.445846E-01, -3.339817E-02, -3.777022E-01, -4.356942E-01,  2.821631E-01,  1.822383E-01, -4.405143E-01, -1.671866E-04, -4.951086E-01,  4.649149E-01,
     4.310806E-01, -1.546575E-01, -4.173418E-01,  5.978147E-02,  7.539136E-02, -2.679542E-01,  3.867962E-01, -3.815940E-01, -2.760670E-02, -2.530614E-01,  1.006026E-02,  9.533447E-02,  1.456857E-02, -1.736704E-01, -2.437367E-01,  3.781830E-01,  3.785315E-01,  1.098488E-01, -3.436619E-01, -5.276969E-02, -1.951311E-01,  1.247390E-01, -3.712652E-02,  1.280765E-01, -2.026834E-01, -1.637867E-01,  3.255672E-01, -4.852592E-01,  4.967659E-01, -7.033909E-02, -1.818707E-01,  6.055791E-02,
     3.690219E-01, -2.453323E-01,  3.682057E-01, -2.496470E-01, -4.938916E-01, -3.737262E-01, -3.097962E-02, -1.947961E-01, -2.901048E-01, -2.278040E-01, -1.414357E-01, -4.406829E-01,  4.618816E-01, -4.418020E-01,  1.929864E-01,  2.375509E-01,  8.582153E-02, -4.477945E-02, -4.794701E-01, -6.375755E-03, -4.476215E-01,  1.961375E-01, -1.392556E-01,  4.915993E-01, -4.445195E-01,  3.862602E-01,  4.026486E-01,  1.728507E-01,  1.116093E-01, -4.994521E-01,  1.803803E-02,  1.913358E-01,
    -4.996291E-01, -3.327773E-01, -5.727662E-02, -4.277658E-01,  1.673386E-01, -7.628016E-02,  1.168096E-01, -2.843158E-01,  3.655179E-02,  4.899004E-01,  3.445300E-01,  6.966520E-02, -3.166740E-01, -1.509410E-01, -3.096268E-01,  3.753581E-01, -6.741076E-02,  2.873517E-02, -4.537689E-01, -4.812524E-01, -1.534383E-01,  1.741539E-01,  1.535701E-01,  2.138529E-01, -3.526908E-01,  3.619041E-01, -4.483316E-01,  2.894651E-01,  1.812585E-01,  9.302171E-02,  3.249648E-01,  4.647132E-01,
     1.442666E-01,  9.577802E-03,  3.183362E-01,  1.815264E-01, -4.099000E-01,  1.087877E-01, -4.775742E-02,  1.700161E-01, -2.085424E-02, -1.499495E-01, -7.372588E-02,  2.984286E-01, -2.130960E-01, -3.082066E-01,  2.907415E-01,  1.681333E-01, -4.346949E-03,  2.836284E-01,  3.997177E-01, -1.833415E-01,  9.805229E-02, -4.569468E-01,  8.196944E-03, -1.453360E-02,  1.731791E-01,  3.361628E-01, -4.144426E-01,  3.630285E-01, -4.615522E-01, -2.846375E-01, -4.854421E-01, -2.305384E-01,
     4.955595E-01, -2.174061E-01,  3.390865E-01, -6.038452E-02,  2.805624E-02, -2.379907E-01, -1.017863E-01,  2.856228E-01,  1.634776E-01,  3.008011E-01, -6.570544E-02,  4.540163E-01, -1.272695E-01, -4.410706E-01,  3.158266E-01, -1.333334E-01, -4.164002E-01, -4.516805E-02,  4.329579E-02, -4.958009E-01,  4.690512E-01,  9.175861E-02,  1.114662E-01, -3.629886E-01, -3.063905E-01,  3.702275E-01,  3.060701E-01,  3.847138E-01,  4.176723E-01, -3.704501E-01, -2.637442E-01, -1.702174E-01,
     3.827642E-01, -3.317867E-01,  4.949805E-01,  4.611175E-01, -3.360146E-01,  4.053337E-01,  4.507842E-01,  1.832785E-01, -6.991883E-02,  2.655250E-01,  2.504401E-02, -2.811434E-01,  6.475781E-02, -3.533755E-01, -4.351103E-01, -3.428205E-01,  1.086504E-01,  2.157680E-02,  1.215732E-01,  1.469007E-01, -1.328328E-01, -9.541816E-02, -3.482513E-01,  2.705956E-01,  3.796133E-01,  1.232190E-01, -1.273145E-01,  3.041624E-02, -4.112843E-01,  2.913993E-02,  3.487906E-01, -3.799946E-01,
    -2.133233E-01, -1.094506E-01,  4.053674E-01,  8.433594E-02, -4.434205E-02,  3.962536E-01,  1.956938E-01,  1.762536E-02,  4.067443E-01,  2.874703E-02, -4.144901E-01, -2.234568E-02,  2.374825E-01,  4.198389E-02, -3.128587E-02, -3.606198E-01, -4.758036E-01,  5.962564E-02,  2.219139E-01,  4.562636E-01, -3.812131E-01,  5.171714E-02, -2.628415E-01,  3.039737E-01,  4.690043E-01,  3.278272E-01, -3.633849E-01,  2.037775E-01, -4.136560E-01, -9.277462E-02, -1.196616E-01,  4.285001E-01,
    -9.299124E-03,  9.229826E-02,  4.017615E-01,  1.073316E-01,  1.777842E-01, -4.398579E-01, -3.162801E-01,  9.923905E-02,  2.822487E-01,  1.755047E-01,  1.233042E-02, -1.252118E-01, -1.754817E-01,  1.124977E-01,  1.374107E-02, -1.467922E-01, -1.096281E-01, -1.044968E-01,  1.166251E-01,  1.651879E-01,  4.150874E-01,  3.211825E-01,  4.122093E-01, -1.423772E-01, -2.922221E-01, -3.892336E-01,  2.180296E-01,  3.270915E-01, -1.543099E-03,  1.256143E-01,  3.263121E-02, -2.053718E-01,
    -4.064753E-01,  2.259507E-01, -5.371781E-02, -8.077152E-02,  5.508161E-02,  1.286541E-01,  1.752966E-01, -2.656522E-01,  7.829830E-02,  2.884913E-01, -4.970920E-01,  4.160127E-01, -4.188059E-01,  1.476040E-01,  4.711501E-01, -2.008373E-01, -1.183010E-01, -3.628561E-01,  2.837805E-01, -3.514707E-01,  3.701848E-01, -3.289338E-01,  2.429271E-02, -3.237516E-02, -3.666991E-01, -1.685109E-01, -1.680825E-01, -3.489091E-01, -3.779778E-02, -1.129703E-02, -3.288944E-01, -4.387612E-01,
     2.609910E-01,  2.817704E-01,  8.445720E-02,  5.493267E-02, -2.723329E-01,  9.356437E-02,  2.175744E-01,  4.348682E-01, -1.143572E-01, -4.703801E-01, -3.556890E-01,  1.398576E-02, -2.118278E-01, -2.129547E-01,  2.736143E-01, -1.264667E-01,  1.295782E-01, -2.583922E-01,  1.431821E-01,  4.632323E-01, -3.492513E-01, -3.491598E-02, -4.472755E-01,  2.535720E-01,  2.992420E-01, -9.917164E-02, -2.865145E-01, -3.514015E-01,  2.906586E-01, -3.115129E-01,  1.279183E-01,  4.492584E-01,
     8.858270E-02,  4.095063E-01, -7.485612E-02,  4.628273E-01, -4.611398E-01,  1.115316E-01,  9.556785E-02, -4.426927E-01, -1.636556E-01, -2.241351E-01,  2.024201E-01, -2.990519E-01,  1.036873E-01,  1.214451E-01, -4.946687E-01, -2.889664E-01, -4.632614E-01, -1.390320E-01, -4.742098E-01, -4.774392E-01, -4.975132E-02, -1.719060E-01, -4.352134E-01,  4.665916E-02,  3.447967E-01,  4.893449E-01,  8.243162E-02,  2.610485E-01, -4.673819E-01, -3.093631E-01,  1.580249E-01,  3.828050E-01,
    -1.130555E-01,  3.353025E-01,  4.303140E-01, -4.544183E-01,  3.848481E-01,  1.065230E-01,  2.826174E-01,  2.525571E-01, -4.865961E-01,  1.413293E-01, -3.089211E-01, -4.013879E-01,  9.033140E-02,  4.053024E-01, -1.436355E-01,  3.172585E-01,  3.706311E-01,  4.258541E-01,  2.605025E-01, -3.697349E-01,  1.327512E-01, -3.303825E-01, -7.513736E-02, -3.828875E-01, -4.424622E-02,  4.957184E-01, -3.026749E-02,  6.439343E-02, -1.911078E-01,  1.782128E-01, -2.290204E-01, -7.913012E-02,
    -3.566552E-01, -4.713114E-01, -4.726985E-01, -4.630416E-01, -2.821953E-01, -9.346480E-02,  8.967527E-02, -2.938178E-01,  8.558013E-02,  6.685157E-02,  3.474154E-01,  3.733634E-01, -4.329876E-01, -1.395576E-01, -6.616963E-02, -1.752209E-01,  3.961271E-01, -4.618040E-01,  3.031841E-01, -4.533544E-01,  3.542684E-01,  4.856028E-01,  3.366465E-01, -3.008440E-01,  2.633143E-01,  1.577970E-02,  1.320625E-01,  1.744278E-01, -3.497989E-02,  7.855326E-02,  7.218831E-02,  2.353463E-01,
    -4.153169E-01, -1.656087E-01, -3.635603E-01,  2.504266E-01,  2.193507E-01,  9.502032E-02,  4.857166E-01, -1.662041E-01, -4.847240E-01, -3.181315E-01, -4.727500E-01,  3.178070E-01, -1.296964E-01,  4.010027E-01,  2.184675E-01,  4.830933E-02, -3.351495E-01,  1.036943E-01,  4.367353E-01,  2.114758E-01,  1.265289E-01, -2.267159E-01,  4.421191E-01,  3.922030E-01,  2.017522E-01, -3.551363E-01, -3.680785E-01,  8.932021E-03,  2.614227E-01, -9.120137E-02,  4.235589E-01,  4.364776E-01,
    -4.327047E-01,  1.742334E-01,  1.823635E-01,  4.164556E-01, -4.308514E-01, -4.443937E-01, -3.463665E-01,  1.323779E-01,  4.310594E-01, -4.005669E-01,  2.346669E-02, -1.599466E-01, -1.862816E-01, -4.893736E-01,  2.547175E-01, -1.012573E-01,  4.041790E-01,  3.883864E-01, -2.700529E-01, -2.558022E-02,  1.422169E-01,  3.974375E-01,  3.403712E-02,  1.785408E-01,  3.048581E-01,  3.621407E-01, -4.528082E-01, -3.574521E-01, -3.005996E-01,  3.895907E-01,  4.803842E-01,  1.355210E-01,
    -6.357431E-02, -4.590636E-01,  5.249115E-02,  2.346309E-01,  1.546961E-01, -2.592068E-01,  3.494315E-01, -3.820798E-01, -8.705999E-02,  1.651055E-01,  4.265233E-01, -1.012897E-02, -3.514581E-01, -1.301549E-01, -2.506924E-01,  1.039988E-01,  2.063444E-01, -2.409290E-01, -1.587616E-01,  3.760629E-01,  1.507912E-02,  2.490492E-02, -4.676640E-01, -2.795945E-01,  4.205389E-01,  3.345857E-01,  4.629485E-01, -1.065876E-01, -1.904486E-01,  4.801265E-01, -1.404098E-02,  1.252998E-01,
     1.262209E-01, -3.548670E-01,  1.745039E-02, -4.482084E-01,  3.442740E-01,  1.803962E-01, -1.238714E-01,  4.871973E-01, -2.992893E-01, -4.616909E-01,  4.840106E-01,  3.942093E-01, -4.988841E-01, -2.456851E-01,  2.238365E-01,  1.051196E-01, -4.904303E-01,  6.708071E-02, -1.700273E-01, -3.838770E-01,  1.805601E-01,  5.465813E-02, -3.344715E-01,  4.588576E-01, -1.466804E-01,  2.528236E-01, -2.991933E-01, -2.334168E-01, -1.026313E-01,  4.854078E-01,  4.136453E-01, -4.626591E-01,
    -4.494479E-01,  2.894740E-01, -4.769977E-01,  1.258489E-01,  1.460873E-01, -2.155658E-01, -4.164685E-01,  4.524710E-01, -2.870306E-02,  4.007205E-01,  3.627122E-01, -4.142429E-01,  1.192558E-01,  1.981805E-01,  7.865785E-02,  4.124074E-01,  8.360050E-02,  2.308081E-01, -2.634707E-01,  4.917250E-01, -2.449839E-01,  3.692146E-01, -2.947331E-01, -3.890987E-01,  4.680175E-01,  7.913242E-02, -2.868498E-01, -2.959255E-01, -2.894488E-01,  3.644542E-01, -3.134565E-01, -3.181394E-01,
     4.400043E-01, -1.947127E-02, -1.426194E-04, -4.990732E-01, -4.122456E-01, -4.067500E-01,  1.845872E-02,  3.094825E-02, -5.677488E-02, -1.198669E-02, -1.833023E-01, -1.331814E-01,  3.471534E-01, -8.741415E-02,  3.113703E-01,  3.324729E-02,  1.624797E-01, -2.716829E-02, -1.667321E-01, -2.173573E-01, -3.666026E-01, -2.349395E-01, -1.590376E-01, -1.269480E-02, -5.222366E-02,  5.206508E-02, -3.449928E-01,  2.585618E-01, -4.934348E-01, -9.864574E-02, -2.301002E-01,  4.824669E-01,
     1.130354E-01, -4.193884E-02,  5.123053E-02,  3.408061E-01,  3.214182E-01, -2.766565E-01, -2.437714E-01,  4.780477E-02, -3.240271E-01,  1.722463E-01,  4.204401E-01, -1.031648E-01, -2.957739E-01, -1.317827E-01,  4.772054E-01,  2.031468E-02,  1.598860E-01,  3.325110E-02,  6.699498E-02,  7.181361E-02, -1.541738E-01,  1.878327E-01, -3.391031E-01,  2.854093E-01, -2.109359E-01,  2.334559E-01, -3.270116E-01,  2.660919E-01,  3.825401E-01,  2.203950E-01, -7.544703E-02, -3.932898E-01,
    -4.758160E-01, -3.980072E-01,  3.001995E-01,  3.758743E-01, -2.623469E-01, -9.527605E-04, -5.970412E-03, -2.482669E-01,  2.240275E-01, -4.654147E-01, -3.677395E-02,  2.753623E-01,  3.531096E-01,  2.172830E-01, -6.380835E-02,  2.081559E-01, -4.232005E-01, -3.687463E-01, -1.508312E-01,  4.027490E-01, -3.039166E-01, -2.322042E-02,  6.476096E-02, -5.011954E-02, -6.268750E-02,  3.661360E-01, -1.547727E-01, -4.493616E-01,  1.120683E-01,  1.336802E-02, -3.622932E-01,  1.655501E-01,
    -2.062327E-01,  1.387336E-02,  1.874501E-01, -3.345463E-01,  1.625577E-01, -2.241084E-01, -4.294041E-01,  4.903631E-01,  4.796705E-01, -4.607841E-02, -4.570920E-01,  4.691524E-01,  3.815305E-01,  2.569994E-01,  3.290484E-01,  6.033248E-02,  1.302635E-01,  3.451965E-02,  3.988291E-01,  4.667667E-01,  2.193550E-01, -4.252518E-01,  1.407458E-01, -4.055438E-01,  5.055352E-02,  3.119353E-01,  4.857746E-01, -4.480721E-01,  3.283248E-01, -3.440241E-02,  1.764115E-01, -5.876768E-02,
    -4.412248E-01,  1.424446E-01,  3.123889E-01,  2.343276E-01,  2.628934E-01, -3.939972E-01,  5.154732E-02, -1.413662E-01,  1.488084E-01, -3.242000E-01, -1.032678E-01,  3.056244E-01,  4.125697E-02, -3.530536E-01,  4.368683E-02,  1.299860E-01, -3.098484E-01, -7.441990E-02, -3.684947E-01, -1.639500E-01, -2.108624E-01,  3.120474E-01,  1.566390E-01,  4.221675E-01, -3.745261E-01, -2.463923E-01, -4.361620E-01, -3.393543E-01, -2.912645E-01,  2.094824E-01, -4.213808E-01, -3.250226E-01,
    -1.605763E-01,  3.579784E-01, -1.725475E-01, -4.551236E-01,  1.773058E-01,  1.597150E-01,  2.718586E-01, -4.931697E-01,  6.087021E-02, -4.142504E-01, -1.968588E-01, -2.878669E-01, -2.418083E-01, -1.624050E-01, -1.758651E-01, -2.224674E-01,  1.778268E-01, -3.822491E-01, -3.638565E-01,  4.488611E-01,  7.067160E-02,  2.629482E-01,  1.868282E-01,  1.311229E-01,  1.442058E-01, -1.794166E-01, -1.111802E-01,  1.521757E-01,  9.560931E-02,  3.319841E-01,  2.407669E-01,  2.596859E-01,
     6.427634E-02,  1.996697E-02, -4.837234E-02, -3.635007E-01, -2.355883E-01, -3.911909E-01, -4.693061E-01, -1.057672E-01,  2.431899E-01,  1.420321E-01, -2.582461E-01,  3.189563E-01,  2.467742E-01, -2.302657E-01,  3.071582E-01, -4.856943E-01, -1.714846E-01, -1.225158E-02, -2.896514E-01,  4.209019E-01, -3.425211E-02, -2.794268E-01,  1.905964E-01, -4.119177E-01,  4.033405E-01, -1.306848E-01,  3.119123E-01,  1.465072E-03, -1.250669E-01,  1.341380E-01, -1.256089E-01,  6.272981E-02,
    -3.730385E-01,  2.445799E-01, -1.819649E-01, -1.299420E-01,  2.558054E-01, -4.803026E-01, -2.904822E-01, -1.206993E-01, -3.727965E-01,  2.482134E-01, -3.398027E-01, -3.150087E-01, -1.716462E-01,  9.138273E-02,  2.616665E-01, -1.023462E-01,  2.443209E-01, -3.726625E-01,  2.714789E-01, -2.068080E-01,  4.851054E-01,  4.712765E-01,  4.425833E-01, -3.149229E-01,  3.165335E-01,  4.576503E-01,  6.549799E-02,  2.561534E-01, -4.757394E-01,  2.126989E-01, -2.301016E-01,  1.909966E-01,
     3.255014E-01, -1.473090E-01, -4.839921E-01,  1.053630E-01, -1.457753E-01,  1.954583E-02, -1.230634E-01,  4.213164E-01,  4.703197E-01, -1.965981E-01,  1.560138E-01,  1.988712E-01,  6.194295E-02,  2.041986E-01, -3.501934E-01,  2.879065E-01,  3.752751E-01,  2.823502E-01, -2.799304E-01,  4.534390E-01, -4.110688E-01,  1.819408E-03, -6.400684E-02,  7.250034E-02,  3.194770E-01, -2.482284E-01,  1.359334E-01, -2.999666E-01,  2.495222E-01,  1.371225E-02,  8.996127E-02, -1.959282E-01,
     3.980111E-01, -3.762940E-02,  3.619008E-01, -2.431299E-01, -3.390916E-01, -1.352091E-01,  3.454161E-01,  2.129696E-01, -3.160823E-02, -2.871977E-02, -1.797823E-01, -2.270227E-01,  4.206560E-03, -1.546558E-01, -4.631887E-01,  2.208897E-01,  9.329899E-02, -2.529579E-02, -2.931211E-01,  1.443371E-01, -3.418623E-02,  1.917080E-01,  1.967328E-01, -4.357621E-01, -2.589749E-01, -3.968784E-01, -2.948156E-01,  4.090917E-01,  3.039705E-01, -4.021755E-01, -1.279935E-01, -2.295244E-01,
};

lm_mat_elem_t elem_b[LM_MAT_SIZE_R * LM_MAT_SIZE_C] = {
    -5.068692E-02,  4.529595E-01, -2.402244E-01,  4.927423E-01,  1.282906E-01,  2.782343E-03,  3.670838E-01,  5.505995E-02,  3.595294E-01,  4.762581E-01,  3.504154E-01, -4.394772E-01,  7.971338E-02,  3.672364E-01,  4.110769E-01, -3.273546E-01, -2.210311E-01, -1.756932E-01, -2.707931E-01, -1.102356E-01, -1.689763E-01,  2.692286E-01, -1.172324E-01,  1.968078E-01,  1.386761E-01,  4.802196E-01, -4.535375E-01, -2.049061E-01, -2.548122E-02, -2.595398E-01, -1.818890E-01, -5.873191E-01,
    -3.260828E-01,  1.444500E-01,  2.324032E-01, -1.651191E-01, -2.162687E-01, -4.135582E-01,  3.347813E-01, -4.575508E-01,  2.077159E-01,  7.424384E-02,  2.315869E-01, -2.242352E-01,  4.223011E-01, -6.594974E-02, -1.859620E-01, -4.344525E-02, -2.917231E-01, -4.203081E-02, -2.403579E-01, -2.071564E-01, -4.074088E-02,  4.048542E-02, -2.989397E-01,  3.892002E-01, -3.768742E-01,  1.755138E-01,  1.362442E-01, -3.759553E-02, -3.718330E-01, -2.185319E-01,  3.175826E-01,  3.776523E-01,
    -1.644226E-01,  4.050738E-02, -2.668418E-01,  1.758801E-01, -2.707162E-02, -4.106088E-01,  3.227917E-01,  6.293081E-02,  2.460809E-02,  4.010398E-01,  1.040374E-02,  2.322762E-01, -3.556379E-01, -3.593578E-01, -4.385169E-01,  1.514710E-01, -4.389694E-01,  3.284955E-01, -4.292944E-01, -4.020696E-01,  2.456226E-01,  2.824979E-01,  1.767342E-01,  2.496034E-01,  3.662912E-01,  4.173077E-01, -4.411503E-01, -1.828823E-02,  1.101752E-02, -3.593220E-02,  2.006838E-01, -3.824810E-01,
     2.888155E-01, -6.561426E-03, -1.716650E-01,  3.447410E-01,  4.839797E-01, -7.821341E-02,  3.142955E-01,  4.202886E-01, -3.091325E-01,  6.872806E-02,  1.493659E-01,  1.734328E-01, -3.716749E-01,  1.011754E-01, -4.144854E-01, -4.799169E-01, -7.862531E-02, -8.542621E-02,  4.975809E-01, -3.131952E-01, -4.330710E-01,  2.890265E-01, -2.811014E-02,  2.900324E-01,  9.688551E-02, -7.069871E-02, -4.621099E-01,  2.080313E-01,  4.974852E-01,  1.548264E-01, -1.181864E-01,  1.512232E-01,
    -1.105415E-01, -1.067619E-01, -4.383735E-01,  3.611166E-01,  1.421799E-01, -3.528305E-01, -1.524444E-01,  4.998508E-01, -7.206802E-02, -1.197685E-01,  3.858161E-01,  4.013634E-01,  1.337477E-01,  1.742362E-01, -1.215445E-02,  4.475450E-01, -3.136177E-01, -1.765360E-01, -2.323502E-01,  2.066035E-01,  1.349698E-01, -2.205426E-01, -2.101286E-01,  3.056373E-02,  1.549902E-01,  2.897856E-02, -2.430630E-01, -1.961023E-01,  1.387239E-01,  2.607676E-02,  4.969739E-01, -2.941163E-01,
    -3.991468E-01, -3.892292E-01,  4.383696E-01,  3.520553E-01,  1.973644E-01, -2.748173E-01,  4.449010E-01, -3.796225E-01, -3.825568E-01,  2.248527E-01, -4.227405E-01,  3.077882E-01,  3.586542E-01, -1.632699E-01, -2.393945E-01,  3.365369E-01, -3.263935E-01,  2.530776E-01, -4.507456E-01,  1.709708E-01, -4.363322E-01, -1.759930E-01,  4.557576E-01,  7.172902E-02, -4.461103E-01, -4.525351E-01,  3.964382E-01, -1.270932E-01, -4.495893E-01, -3.436811E-01,  1.897393E-01,  3.424544E-01,
     1.672010E-01,  2.711855E-01,  4.241367E-01, -4.148964E-01, -3.173032E-01, -1.584433E-01, -2.407366E-01,  3.269388E-01, -4.764247E-01, -3.161984E-01,  5.073969E-02, -1.030755E-01,  4.601971E-01, -3.886950E-01, -2.548215E-01,  7.448005E-02, -8.215913E-02,  1.153378E-03,  8.986129E-02,  3.925462E-01,  3.909630E-01, -2.462375E-01, -3.106508E-01,  2.296194E-01, -1.543034E-01,  4.986284E-01, -1.369681E-01, -2.013563E-01, -4.553333E-01, -3.235048E-01,  2.227069E-01,  3.914653E-01,
     3.717212E-01,  1.020171E-01, -1.141915E-01,  1.564077E-01, -2.442255E-02, -3.014595E-01,  1.168296E-01,  4.022473E-01,  3.727710E-01,  2.334131E-01, -1.447752E-01,  9.035229E-02,  4.779397E-01, -2.042142E-01,  2.543540E-01, -3.282104E-01, -1.216490E-01,  1.193244E-01,  1.383398E-01, -1.298615E-01, -2.138328E-01, -4.375894E-01,  8.509170E-02,  3.598056E-01,  9.667830E-02, -3.849861E-01,  4.846511E-02, -4.555632E-01, -2.602574E-01, -1.340199E-01,  1.576232E-01, -4.385174E-01,
    -1.430614E-01, -2.815638E-01,  3.046268E-01, -3.838601E-02,  1.621545E-01, -2.577938E-01, -2.582643E-01, -3.253309E-02,  2.409985E-02,  4.114920E-01, -4.365489E-01,  4.004828E-01, -1.746443E-02,  4.750927E-01, -1.044601E-01,  7.325517E-02,  3.804277E-01,  1.136298E-01, -3.497062E-01, -2.476715E-01, -5.916399E-02, -2.850246E-01, -2.325087E-01, -4.442205E-01,  7.063301E-02,  4.513281E-01,  2.332432E-01, -1.343201E-01, -3.752078E-01,  2.777383E-01,  4.814650E-01,  3.890715E-01,
     3.625311E-01,  1.750288E-01,  1.642985E-01, -3.842684E-01, -5.026623E-02, -3.936359E-01, -5.396958E-02, -3.759681E-01, -2.210262E-01, -4.686799E-01,  9.967333E-02,  1.984785E-01,  1.116822E-02, -4.101900E-02,  3.467601E-01, -3.673813E-01, -4.554448E-01,  2.095253E-01, -2.137761E-01, -1.900398E-02,  3.704012E-02, -2.149471E-01, -3.964757E-01, -1.907753E-01,  3.687378E-01,  3.282020E-01,  2.330719E-01, -1.512676E-01, -1.916287E-01, -5.455655E-02, -1.656794E-01, -8.155725E-02,
     2.626647E-01,  1.869703E-01,  3.770422E-01,  3.204683E-01, -4.049552E-01,  7.867097E-02, -2.933920E-01,  4.802140E-01,  3.388187E-01, -1.270586E-01, -1.957262E-01,  1.693905E-03,  3.874223E-01, -6.264085E-02,  1.220718E-01, -3.836684E-01, -3.341393E-01, -8.463122E-02, -4.419513E-01, -3.070596E-01, -3.607615E-01,  3.859738E-01, -4.546727E-01,  2.925618E-01,  3.603088E-01,  4.960044E-01, -2.610637E-01,  9.014502E-03, -1.687887E-01,  3.128978E-01, -4.719679E-01, -3.722915E-01,
    -4.056020E-01, -1.663332E-02, -4.840538E-01,  1.749511E-01,  7.294361E-02, -5.389781E-02, -3.654669E-01,  4.257543E-01,  3.959522E-02,  3.472566E-01,  2.288339E-01,  2.435011E-01,  6.650527E-02,  4.113584E-01,  3.596219E-02, -3.571599E-01, -2.861071E-01, -3.812233E-01, -4.692038E-01,  3.248925E-01,  6.424724E-02,  4.783995E-01,  1.651276E-01, -5.957210E-02,  2.297861E-01,  1.666261E-01, -2.309346E-01,  4.697899E-01, -1.604005E-01, -2.230877E-01, -4.380737E-01, -2.931272E-01,
     1.886035E-01,  4.790377E-01, -1.187326E-01,  3.793644E-01, -2.352054E-01, -1.453574E-02,  3.899475E-01,  2.401701E-01,  1.659085E-01, -1.129147E-01, -3.848527E-01,  4.205423E-01, -4.129458E-01, -3.873947E-01, -1.852496E-01,  1.834526E-01, -2.323842E-01, -3.229954E-01, -9.792657E-02, -6.274031E-02, -6.334864E-03, -3.188324E-01, -3.176525E-01, -1.590953E-01, -3.779669E-01,  1.779062E-02,  3.776284E-01,  2.459604E-01,  4.976131E-01,  4.184458E-01,  2.121303E-01, -3.020773E-01,
     4.103569E-02,  1.717877E-01,  3.154071E-01, -2.129726E-01, -1.031089E-01, -2.464284E-01,  4.742434E-02,  1.719795E-01,  4.380733E-01,  3.976232E-01,  2.946566E-01,  3.585629E-01, -3.726798E-01,  1.052230E-01,  1.862081E-01,  4.106357E-01,  2.421366E-02, -3.872574E-01, -1.297218E-01, -2.519468E-01, -1.274041E-01,  3.333460E-02,  8.960531E-02,  6.392394E-02, -9.033448E-02, -2.476408E-02,  3.402912E-01, -1.357084E-01, -4.682838E-01,  4.855312E-01, -1.344018E-01, -1.254305E-01,
    -2.837023E-01, -2.124942E-01, -4.522691E-01,  5.629576E-02, -1.622687E-03,  3.171632E-02,  2.369906E-01,  1.546589E-01, -4.200013E-01,  2.994415E-02,  4.036761E-01,  1.537934E-01,  2.993640E-01,  2.228013E-02, -7.439315E-02,  6.666353E-02, -5.350145E-02, -3.277777E-01,  1.012115E-01, -3.240452E-01, -9.320980E-02,  3.462140E-01, -2.069318E-01, -4.549705E-01, -1.356214E-01,  4.301982E-01, -3.646141E-01,  4.111502E-01,  2.169102E-01,  3.785744E-01, -4.487460E-01, -3.925649E-01,
     3.767298E-02,  5.327847E-02, -2.079188E-01,  4.399095E-01, -1.060725E-01, -2.742833E-01,  3.562340E-02,  2.253094E-01, -3.812977E-01, -6.737871E-02,  1.933371E-01,  1.454677E-01, -1.446730E-01, -1.717394E-01, -4.180590E-01,  3.485013E-01,  9.899462E-02, -4.221147E-02, -2.491112E-01, -3.287096E-02, -3.603135E-02, -4.851288E-01, -4.929086E-01, -4.553549E-01,  2.346489E-01,  3.544014E-01,  4.866520E-01,  3.068368E-01,  1.174079E-01, -7.097925E-02,  4.937474E-01, -3.976130E-01,
    -4.412824E-02, -3.559566E-01, -2.338228E-01,  3.018409E-01, -1.731216E-01,  3.442650E-01,  2.633370E-02, -1.289061E-01, -4.369769E-01, -6.438659E-02,  1.920766E-01, -2.372108E-01,  3.577839E-01, -1.540924E-01,  5.517478E-02,  3.551171E-01,  2.323817E-01, -3.303672E-02,  2.487379E-02,  4.623500E-01,  7.699847E-02, -3.205439E-01, -1.047884E-01, -2.655265E-01, -6.281792E-02, -3.878555E-01,  5.180635E-02,  1.037678E-01, -1.969127E-01,  3.651681E-01, -2.528657E-01, -5.864799E-02,
     9.527657E-02, -4.928346E-01, -5.426833E-02,  1.276650E-01,  1.166116E-01,  4.893279E-01,  3.404342E-01, -3.423652E-01, -2.034011E-01, -1.878849E-01, -3.153848E-01, -3.335402E-01, -3.450151E-01, -3.351497E-01, -7.740302E-02, -4.886764E-01, -1.528617E-01,  5.472567E-02, -2.342268E-02, -3.663513E-01, -3.809296E-01,  3.925317E-01, -3.236295E-01,  1.795663E-02,  1.484502E-01,  2.902454E-01,  1.970042E-01, -4.487549E-01,  1.234236E-01, -4.581297E-01, -4.981893E-01,  4.537403E-01,
     2.203878E-01, -3.652908E-01,  1.364033E-01, -4.075606E-01, -4.224396E-01,  1.659151E-01,  3.234143E-01, -3.570236E-01,  3.370745E-01, -4.337366E-01,  3.961591E-01, -2.681174E-01, -4.295243E-01, -2.032565E-01, -3.213371E-01,  2.841581E-01,  2.201379E-01, -4.595154E-01,  3.005818E-01,  2.129012E-01, -9.615455E-02,  2.374862E-01,  7.536092E-02, -2.536353E-01,  4.524872E-01, -1.523525E-01, -3.917616E-01, -2.279481E-01,  1.105591E-02,  1.703952E-01, -3.675568E-01, -4.073864E-03,
    -4.848963E-01,  1.636229E-01,  1.587024E-01,  2.276902E-02, -1.752724E-01, -4.559671E-01,  2.886332E-01, -2.894218E-01, -2.118211E-01, -3.390110E-01, -3.850346E-01, -4.841942E-01, -7.126651E-02,  6.593080E-02,  4.427150E-01, -1.964020E-01,  4.596667E-01,  9.738114E-03,  3.339616E-02, -3.570963E-01, -4.969550E-01,  3.142001E-01, -2.647498E-01, -3.313523E-01,  4.301895E-01,  1.104711E-01, -1.509192E-01, -2.517992E-01, -2.786542E-01, -2.446713E-01,  2.131424E-01,  2.443823E-01,
    -3.592597E-01,  4.109946E-01, -3.615874E-01, -3.045290E-01, -2.775933E-02,  1.576345E-01, -2.724513E-01, -3.639269E-01,  3.528817E-01,  4.700455E-01,  2.925058E-01, -3.207367E-01,  2.463461E-01, -1.354387E-01, -3.809387E-01,  2.495319E-02,  4.806337E-01, -1.757274E-01,  1.567321E-01,  3.069592E-01, -4.773852E-01, -4.324698E-01,  4.307266E-01,  7.250716E-02,  4.449168E-01, -4.995827E-01,  6.839840E-02, -2.152641E-01, -4.350614E-01, -2.858220E-01,  4.680899E-01,  4.335144E-01,
     4.786528E-01, -1.661268E-01, -7.879335E-03,  2.178276E-01, -2.105959E-02,  4.276402E-02, -2.742279E-01,  1.700599E-01, -3.835378E-01, -2.887035E-01,  1.572528E-01, -1.349510E-01,  2.514604E-01,  4.934036E-01, -5.806283E-02, -3.403733E-01, -2.644474E-01,  8.708809E-02, -1.123071E-01,  3.654585E-01, -3.594443E-02, -3.329761E-01,  4.519293E-01, -3.436452E-01,  3.383634E-01,  2.851462E-01, -8.177648E-02, -4.280161E-01, -1.919303E-01, -3.802184E-02, -3.152310E-01, -2.717161E-01,
     1.396297E-01,  2.343452E-01, -1.628411E-01, -2.293199E-01, -2.752782E-01,  3.020843E-01,  4.177402E-01, -1.115554E-01,  1.638319E-01, -4.791638E-01,  4.769419E-01,  4.725538E-02, -4.774344E-02,  4.862257E-01,  4.239541E-01, -3.169745E-01,  2.105996E-01, -4.848200E-01,  6.234248E-02, -4.369965E-01,  1.435586E-01,  4.195463E-01,  4.048414E-01, -2.718256E-01, -2.881170E-01, -3.593487E-01, -2.324727E-01,  4.679925E-01, -1.990395E-01,  7.011085E-02,  1.740207E-01, -1.171820E-01,
    -1.045844E-01, -4.851815E-01, -7.734956E-02,  2.304138E-01,  4.208993E-01, -1.944942E-01,  3.982792E-01, -7.958418E-02,  4.704089E-02,  1.480188E-01,  1.832486E-01,  1.704750E-01,  1.234882E-01,  3.053494E-01, -1.863061E-01, -3.032439E-01, -4.242506E-02,  1.826889E-02,  1.305676E-02, -3.600844E-02, -4.794829E-01, -4.080221E-01, -3.365933E-01,  7.219758E-02,  2.845506E-01, -3.426977E-02, -3.917657E-01, -4.090011E-01, -1.782843E-01, -1.527797E-01,  4.954145E-01, -3.220264E-01,
     9.966828E-02, -4.345166E-01, -4.705406E-01, -2.810768E-01,  4.024726E-01, -2.199466E-01,  3.242624E-01,  1.317731E-01, -4.090502E-01,  4.163607E-01, -2.170709E-01,  3.041708E-01, -1.570290E-01, -8.389062E-02, -4.933348E-01, -1.282810E-01, -4.793006E-01,  4.821389E-01,  6.572239E-02, -4.524800E-01, -2.233675E-01,  4.330261E-01, -1.181801E-01,  1.987644E-01, -4.416758E-01,  7.284500E-02,  4.821710E-01, -4.317245E-01,  3.070771E-01, -7.185896E-02,  1.750663E-01, -1.687229E-01,
     7.400984E-02, -2.554834E-01, -3.032583E-01,  4.988936E-01,  2.561001E-01,  3.727621E-01,  3.858480E-01, -2.518693E-01, -3.712407E-01, -1.939025E-01, -7.347745E-02, -1.657344E-01,  3.889977E-01, -3.107040E-01, -4.316513E-01, -4.197569E-02,  2.728353E-01,  2.604750E-01,  2.930183E-01, -3.789156E-01,  1.272197E-01,  4.526634E-01, -2.506822E-01,  1.892207E-02,  9.650780E-02, -6.582980E-02, -3.591008E-02, -2.711580E-01,  1.697672E-01,  1.022232E-01, -2.676194E-01,  2.816025E-01,
    -3.640616E-01,  6.016976E-02, -3.885777E-01,  3.217287E-01, -2.843353E-01, -3.006796E-01, -1.665521E-01, -4.412764E-01, -5.329541E-03,  4.173554E-01, -4.571695E-01, -4.479044E-01, -2.262202E-01, -1.140763E-01, -4.768805E-01, -2.699522E-01,  1.509385E-01,  3.152029E-01, -3.074256E-01, -3.883868E-02,  2.816876E-01,  1.479077E-02,  3.894634E-01, -4.057851E-01, -1.441794E-01, -3.441646E-01, -2.972365E-02, -3.995311E-01,  2.976648E-01,  3.189299E-02, -3.475446E-01,  2.354852E-01,
     3.784997E-01,  2.470622E-01, -3.639578E-01,  2.647013E-01, -3.798639E-01,  3.198454E-01, -2.260603E-01, -1.859237E-01,  2.545232E-01,  1.928519E-01, -3.158050E-01, -7.841778E-02, -2.236657E-01, -2.630198E-01,  1.903310E-01, -1.560597E-01, -1.274539E-01, -3.128575E-01,  2.732139E-01,  2.828142E-01, -2.132204E-01, -1.869852E-01, -1.827342E-01, -3.350889E-01,  1.637151E-01,  8.382196E-02, -5.445510E-02,  1.256486E-01,  6.260734E-02,  4.216873E-01, -4.846271E-01, -2.634079E-01,
     4.121837E-01, -4.543214E-01, -2.503251E-01,  3.028832E-01,  3.551384E-01, -1.996922E-01, -2.226108E-03,  4.397251E-01, -1.513007E-01, -2.140310E-01, -4.020420E-01, -2.831868E-01,  4.556103E-01, -3.891073E-01, -2.584039E-01, -1.343076E-01, -2.960191E-01,  1.517724E-01, -2.595976E-01, -1.798202E-01, -3.273734E-01, -1.361104E-01, -2.574496E-01,  1.171758E-03, -2.651090E-01, -4.733792E-01, -4.099550E-01, -2.575169E-02, -3.928671E-01,  8.586360E-02,  2.033320E-01,  3.157274E-01,
     4.953208E-01, -2.272992E-01, -2.203300E-01,  4.453027E-01, -4.354920E-01, -2.121234E-01, -1.269226E-02, -1.557547E-01,  4.408004E-01,  4.430837E-01,  1.682529E-01,  2.869776E-01, -3.219357E-01,  4.790892E-01, -2.772135E-02, -2.153026E-01, -4.797510E-01,  1.647436E-01,  2.660185E-01,  1.786501E-01, -4.590074E-01,  6.220547E-02, -3.499571E-01, -1.139962E-01,  2.276871E-01,  1.808455E-01,  9.573328E-02,  4.005546E-01, -1.099085E-02,  1.288870E-01,  4.498358E-02,  4.416681E-01,
    -2.059927E-01, -4.148299E-01, -2.847038E-01, -1.839314E-02,  4.791187E-02,  1.394513E-02, -2.541752E-01, -4.474271E-01,  1.978888E-01, -1.117277E-01,  1.254526E-01, -2.259214E-02, -2.223226E-01,  2.149686E-01, -3.000659E-01, -4.128660E-01,  3.451551E-01, -6.086739E-03,  2.748440E-01,  3.650108E-01,  3.292758E-01, -2.224980E-01,  4.223656E-01, -4.339546E-01, -1.534178E-01,  5.028604E-02,  4.609081E-01,  4.790167E-01,  4.347855E-01,  3.989439E-02,  4.140363E-01,  7.520761E-02,
    -4.697713E-01,  2.954256E-01,  3.153305E-01,  4.042904E-02, -1.454314E-01,  1.289062E-01, -1.006946E-02, -3.437220E-01,  4.831823E-01,  6.310587E-02,  4.668509E-01, -8.192666E-02,  3.658571E-01,  3.556450E-02, -4.214546E-01,  1.951170E-01,  1.442263E-01,  4.158679E-01,  4.368959E-01, -3.982607E-01, -4.587911E-01, -2.052164E-02,  2.779516E-01,  3.000146E-01, -3.929876E-01, -3.846571E-02,  1.579129E-01,  1.343266E-01, -3.337905E-02, -2.942302E-02, -1.528960E-01,  1.638111E-01,
};

lm_mat_elem_t elem_c[LM_MAT_SIZE_R * LM_MAT_SIZE_C] = {0};


/*
 *******************************************************************************
 * Public functions declaration
 *******************************************************************************
 */


/*
 *******************************************************************************
 * Private functions declaration
 *******************************************************************************
 */


/*
 *******************************************************************************
 * Public functions
 *******************************************************************************
 */

/**
 * main - Lin matrix example code
 *
 * @return  [lm_rtn_t]  Function executing result.
 * @retval  [0]         Success.
 * @retval  [-N]        Failure (error code).
 *
 */
int32_t main()
{
    lm_rtn_t result;
    lm_mat_t mat_a = {0};
    lm_mat_t mat_b = {0};
    lm_mat_t mat_c = {0};
    clock_t begin;
    clock_t end;

    /* Setup required matrix handles for computation */
    result = lm_mat_set(&mat_a, LM_MAT_SIZE_R, LM_MAT_SIZE_C, (lm_mat_elem_t *)elem_a,
                        (sizeof(elem_a) / sizeof(elem_a[0])));
    LM_RETURN_IF_ERR(result);

    result = lm_mat_set(&mat_b, LM_MAT_SIZE_R, LM_MAT_SIZE_C, (lm_mat_elem_t *)elem_b,
                        (sizeof(elem_b) / sizeof(elem_b[0])));
    LM_RETURN_IF_ERR(result);

    result = lm_mat_set(&mat_c, LM_MAT_SIZE_R, LM_MAT_SIZE_C, (lm_mat_elem_t *)elem_c,
                        (sizeof(elem_c) / sizeof(elem_c[0])));
    LM_RETURN_IF_ERR(result);

    /*
     * Measure the performance of GEMM function
     */

    begin = clock();

    for (int i = 0; i < 10; i++) {

        /* Compute C := A * B */
        result = lm_oper_gemm(false, false,
                            LM_MAT_ONE_VAL, &mat_a, &mat_b,
                            LM_MAT_ZERO_VAL, &mat_c);
        LM_RETURN_IF_ERR(result);

        /* Compute C := A' * B */
        result = lm_oper_gemm(true, false,
                            LM_MAT_ONE_VAL, &mat_a, &mat_b,
                            LM_MAT_ZERO_VAL, &mat_c);
        LM_RETURN_IF_ERR(result);

        /* Compute C := A * B' */
        result = lm_oper_gemm(false, true,
                            LM_MAT_ONE_VAL, &mat_a, &mat_b,
                            LM_MAT_ZERO_VAL, &mat_c);
        LM_RETURN_IF_ERR(result);

        /* Compute C := A' * B' */
        result = lm_oper_gemm(true, true,
                            LM_MAT_ONE_VAL, &mat_a, &mat_b,
                            LM_MAT_ZERO_VAL, &mat_c);
        LM_RETURN_IF_ERR(result);
    }

    end = clock();

    printf("GEMM, elapsed: %f seconds\n", (double)(end - begin) / CLOCKS_PER_SEC);

    /*
     * Measure the performance of AXPY function
     */

    begin = clock();

    for (int i = 0; i < 10; i++) {

        /* Compute A := 0.1 * C + A */
        result = lm_oper_axpy(0.1, &mat_c, &mat_a);
        LM_RETURN_IF_ERR(result);

        /* Compute A := 2.0 * C + A */
        result = lm_oper_axpy(2.0, &mat_c, &mat_a);
        LM_RETURN_IF_ERR(result);

        /* Compute B := 0.1 * A + B */
        result = lm_oper_axpy(0.1, &mat_a, &mat_b);
        LM_RETURN_IF_ERR(result);

        /* Compute B := 2.0 * A + B */
        result = lm_oper_axpy(2.0, &mat_a, &mat_b);
        LM_RETURN_IF_ERR(result);

        /* Compute C := 0.1 * B + C */
        result = lm_oper_axpy(0.1, &mat_b, &mat_c);
        LM_RETURN_IF_ERR(result);

        /* Compute C := 2.0 * B + C */
        result = lm_oper_axpy(2.0, &mat_b, &mat_c);
        LM_RETURN_IF_ERR(result);

    }

    end = clock();

    printf("AXPY, elapsed: %f seconds\n", (double)(end - begin) / CLOCKS_PER_SEC);

#if 0
    printf("\nMatrix A:\n");
    lm_mat_dump(&mat_a);

    printf("\nMatrix B:\n");
    lm_mat_dump(&mat_b);

    printf("\nMatrix A * B:\n");
    lm_mat_dump(&mat_c);
#endif

    result = lm_mat_clr(&mat_a);
    LM_RETURN_IF_ERR(result);

    result = lm_mat_clr(&mat_b);
    LM_RETURN_IF_ERR(result);

    result = lm_mat_clr(&mat_c);
    LM_RETURN_IF_ERR(result);

    return 0;
}


/*
 *******************************************************************************
 * Private functions
 *******************************************************************************
 */

